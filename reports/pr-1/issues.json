{
  "status": "success",
  "pr_summary": "## üõ°Ô∏è PullGuard Security Review\n\n**Status:** ‚ùå FAILED\n\n### üìä Analysis Results\n\n**AST Policy Violations:** 13 _(all posted, no limit)_\n- üî¥ Critical: 8\n- üü† High: 5\n- üü° Medium: 0\n- üîµ Low: 0\n\n**ü§ñ AI-Powered Code Fixes:** 13 _(max: 30)_\n- Semantic error detection\n- Security vulnerability fixes\n- Replaceable code suggestions\n\n### üîç Top Critical Issues\n\n1. üî¥ **Dangerous use of 'eval()' detected. This can execute arbitrary code.**\n   - File: `api.py:50`\n   - Rule: `PY-AST-001`\n\n2. üî¥ **Hardcoded API key detected. Use environment variables or secrets management.**\n   - File: `api.py:12`\n   - Rule: `PY-SECRET-001`\n\n3. üî¥ **Command injection via os.system() with f-string. Use parameterized commands or shell=False.**\n   - File: `api.py:19`\n   - Rule: `PY-CMD-001`\n\n4. üî¥ **Command injection via subprocess with shell=True. Use parameterized commands or shell=False.**\n   - File: `api.py:22`\n   - Rule: `PY-CMD-001`\n\n5. üî¥ **Hardcoded password detected. Use environment variables or secrets management.**\n   - File: `database.py:9`\n   - Rule: `PY-SECRET-001`\n\n---\n_üí° Click on AI suggestions in inline comments to apply fixes directly_\n\n*Powered by [PullGuard](https://github.com/sristikulkarni-gif/PullGuardProject) - Azure AI Security Analysis*\n",
  "violations": {
    "total": 13,
    "critical": 8,
    "high": 5,
    "medium": 0,
    "low": 0,
    "details": [
      {
        "id": "PY-AST-001",
        "file": "api.py",
        "line": 50,
        "severity": "critical",
        "message": "Dangerous use of 'eval()' detected. This can execute arbitrary code."
      },
      {
        "id": "PY-SECRET-001",
        "file": "api.py",
        "line": 12,
        "severity": "critical",
        "message": "Hardcoded API key detected. Use environment variables or secrets management."
      },
      {
        "id": "PY-CMD-001",
        "file": "api.py",
        "line": 19,
        "severity": "critical",
        "message": "Command injection via os.system() with f-string. Use parameterized commands or shell=False."
      },
      {
        "id": "PY-CMD-001",
        "file": "api.py",
        "line": 22,
        "severity": "critical",
        "message": "Command injection via subprocess with shell=True. Use parameterized commands or shell=False."
      },
      {
        "id": "PY-CRYPTO-001",
        "file": "api.py",
        "line": 36,
        "severity": "high",
        "message": "Using insecure random module for security. Use secure alternatives."
      },
      {
        "id": "PY-CRYPTO-001",
        "file": "api.py",
        "line": 44,
        "severity": "high",
        "message": "Insecure deserialization with pickle. Use secure alternatives."
      },
      {
        "id": "PY-CRYPTO-001",
        "file": "crypto.py",
        "line": 15,
        "severity": "high",
        "message": "Weak hashing algorithm (MD5/SHA1). Use secure alternatives."
      },
      {
        "id": "PY-CRYPTO-001",
        "file": "crypto.py",
        "line": 31,
        "severity": "high",
        "message": "Using insecure random module for security. Use secure alternatives."
      },
      {
        "id": "PY-CRYPTO-001",
        "file": "crypto.py",
        "line": 38,
        "severity": "high",
        "message": "Weak hashing algorithm (MD5/SHA1). Use secure alternatives."
      },
      {
        "id": "PY-SECRET-001",
        "file": "database.py",
        "line": 9,
        "severity": "critical",
        "message": "Hardcoded password detected. Use environment variables or secrets management."
      },
      {
        "id": "PY-SECRET-001",
        "file": "database.py",
        "line": 10,
        "severity": "critical",
        "message": "Hardcoded API key detected. Use environment variables or secrets management."
      },
      {
        "id": "PY-SQL-001",
        "file": "database.py",
        "line": 22,
        "severity": "critical",
        "message": "SQL injection via f-string formatting. Use parameterized queries."
      },
      {
        "id": "PY-SQL-001",
        "file": "database.py",
        "line": 40,
        "severity": "critical",
        "message": "SQL injection via f-string in UPDATE. Use parameterized queries."
      }
    ]
  },
  "ai_suggestions": 13,
  "comments_posted": 27,
  "policy_status": "failed",
  "cost_summary": {
    "total_tokens": 3800,
    "total_cost_usd": 0.1235,
    "max_cost_usd": 0.5,
    "remaining_budget_usd": 0.3765,
    "budget_exceeded": false
  },
  "timestamp": "2026-02-08T13:39:49.891187",
  "pr_summary_path": "/tmp/pullguard-artifacts/pr_summary.md",
  "issues_json_path": "/tmp/pullguard-artifacts/issues.json",
  "policy_report_path": "/tmp/pullguard-artifacts/policy_report.md",
  "violations_count": 13,
  "failed_on_policy": true,
  "repository": "sristikulkarni-gif/PullGuardTest",
  "pr_number": 1
}
